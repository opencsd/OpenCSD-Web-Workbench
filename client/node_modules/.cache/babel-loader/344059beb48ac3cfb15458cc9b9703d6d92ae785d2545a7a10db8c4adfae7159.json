{"ast":null,"code":"/* eslint no-proto: \"off\" */\n\n// Big thanks to @WebReflection for sorting this out\n// https://gist.github.com/WebReflection/5593554\n\n\"use strict\";\n\nvar isObject = require(\"../is-object\"),\n  value = require(\"../valid-value\"),\n  objIsPrototypeOf = Object.prototype.isPrototypeOf,\n  defineProperty = Object.defineProperty,\n  nullDesc = {\n    configurable: true,\n    enumerable: false,\n    writable: true,\n    value: undefined\n  },\n  validate;\nvalidate = function validate(obj, prototype) {\n  value(obj);\n  if (prototype === null || isObject(prototype)) return obj;\n  throw new TypeError(\"Prototype must be null or an object\");\n};\nmodule.exports = function (status) {\n  var fn, set;\n  if (!status) return null;\n  if (status.level === 2) {\n    if (status.set) {\n      set = status.set;\n      fn = function fn(obj, prototype) {\n        set.call(validate(obj, prototype), prototype);\n        return obj;\n      };\n    } else {\n      fn = function fn(obj, prototype) {\n        validate(obj, prototype).__proto__ = prototype;\n        return obj;\n      };\n    }\n  } else {\n    fn = function self(obj, prototype) {\n      var isNullBase;\n      validate(obj, prototype);\n      isNullBase = objIsPrototypeOf.call(self.nullPolyfill, obj);\n      if (isNullBase) delete self.nullPolyfill.__proto__;\n      if (prototype === null) prototype = self.nullPolyfill;\n      obj.__proto__ = prototype;\n      if (isNullBase) defineProperty(self.nullPolyfill, \"__proto__\", nullDesc);\n      return obj;\n    };\n  }\n  return Object.defineProperty(fn, \"level\", {\n    configurable: false,\n    enumerable: false,\n    writable: false,\n    value: status.level\n  });\n}(function () {\n  var tmpObj1 = Object.create(null),\n    tmpObj2 = {},\n    set,\n    desc = Object.getOwnPropertyDescriptor(Object.prototype, \"__proto__\");\n  if (desc) {\n    try {\n      set = desc.set; // Opera crashes at this point\n      set.call(tmpObj1, tmpObj2);\n    } catch (ignore) {}\n    if (Object.getPrototypeOf(tmpObj1) === tmpObj2) return {\n      set: set,\n      level: 2\n    };\n  }\n  tmpObj1.__proto__ = tmpObj2;\n  if (Object.getPrototypeOf(tmpObj1) === tmpObj2) return {\n    level: 2\n  };\n  tmpObj1 = {};\n  tmpObj1.__proto__ = tmpObj2;\n  if (Object.getPrototypeOf(tmpObj1) === tmpObj2) return {\n    level: 1\n  };\n  return false;\n}());\nrequire(\"../create\");","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}